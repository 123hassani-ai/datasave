<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrolling Jalali Picker Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¨Ø§ TailwindCSS</title>
    
    <!-- ÙÙˆÙ†Øª ÙˆØ²ÛŒØ±Ù…ØªÙ† -->
    <link href="assets/fonts/vazirmatn.css" rel="stylesheet">
    
    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body {
            font-family: 'Vazirmatn', 'Tahoma', sans-serif;
        }
        
        /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ Ø³ÙØ§Ø±Ø´ÛŒ */
        .picker-slide-up {
            animation: slideUp 0.3s ease-out;
        }
        
        .picker-slide-down {
            animation: slideDown 0.3s ease-out;
        }
        
        @keyframes slideUp {
            from {
                transform: translate(-50%, 100%);
                opacity: 0;
            }
            to {
                transform: translate(-50%, -50%);
                opacity: 1;
            }
        }
        
        @keyframes slideDown {
            from {
                transform: translate(-50%, -50%);
                opacity: 1;
            }
            to {
                transform: translate(-50%, 100%);
                opacity: 0;
            }
        }
        
        /* Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ø§Ø± Ø³ÙØ§Ø±Ø´ÛŒ */
        .custom-scroll::-webkit-scrollbar {
            width: 6px;
        }
        
        .custom-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .custom-scroll::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 10px;
        }
        
        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: #5a6fd8;
        }
        
        /* Ù‡Ø§ÛŒÙ„Ø§ÛŒØª Ø¢ÛŒØªÙ… ÙØ¹Ø§Ù„ */
        .picker-item-highlight {
            position: relative;
            overflow: hidden;
        }
        
        .picker-item-highlight::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        
        .picker-item-highlight:hover::before {
            left: 100%;
        }
        
        /* Ú¯Ø±Ø§Ø¯ÛŒØ§Ù† ÙÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ø§Ø³Ú©Ø±ÙˆÙ„ */
        .scroll-fade {
            position: relative;
        }
        
        .scroll-fade::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: linear-gradient(to bottom, white, transparent);
            z-index: 1;
            pointer-events: none;
        }
        
        .scroll-fade::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: linear-gradient(to top, white, transparent);
            z-index: 1;
            pointer-events: none;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-400 via-purple-500 to-pink-500 min-h-screen p-4">
    <div class="container mx-auto max-w-6xl">
        <!-- Ù‡Ø¯Ø± -->
        <div class="text-center text-white mb-8">
            <h1 class="text-4xl md:text-5xl font-bold mb-4 drop-shadow-lg">
                ğŸ¯ Scrolling Jalali Picker Ù¾ÛŒØ´Ø±ÙØªÙ‡
            </h1>
            <p class="text-lg md:text-xl opacity-90">
                Ø¨Ø§ TailwindCSS Ùˆ JavaScript Ø®Ø§Ù… - ØªØ¬Ø±Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ù…Ø¯Ø±Ù†
            </p>
        </div>

        <!-- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ ØªØ³Øª -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <!-- Ù¾ÛŒÚ©Ø± Ø§ØµÙ„ÛŒ -->
            <div class="bg-white/10 backdrop-blur-md rounded-2xl p-6 shadow-2xl border border-white/20">
                <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                    <span class="bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-3 py-1 rounded-full text-sm">Ù¾ÛŒØ´Ø±ÙØªÙ‡</span>
                    Scrolling Picker Ø§ØµÙ„ÛŒ
                </h2>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-white font-semibold mb-2">ØªØ§Ø±ÛŒØ® ØªÙˆÙ„Ø¯:</label>
                        <input type="text" id="birthDate" 
                               class="w-full p-3 rounded-xl bg-white/90 border border-gray-200 focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all duration-300 cursor-pointer" 
                               placeholder="Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ØªØ§ ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯..." readonly>
                    </div>
                    
                    <div>
                        <label class="block text-white font-semibold mb-2">ØªØ§Ø±ÛŒØ® Ø´Ø±ÙˆØ¹ Ú©Ø§Ø±:</label>
                        <input type="text" id="workDate" 
                               class="w-full p-3 rounded-xl bg-white/90 border border-gray-200 focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all duration-300 cursor-pointer" 
                               placeholder="Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ØªØ§ ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯..." readonly>
                    </div>
                </div>
                
                <div class="flex flex-wrap gap-2 mt-6">
                    <button onclick="showDemo()" class="bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white px-4 py-2 rounded-lg transition-all duration-300 transform hover:scale-105">
                        ğŸ® Ù†Ù…Ø§ÛŒØ´ Ø¯Ù…Ùˆ
                    </button>
                    <button onclick="clearAll()" class="bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-600 hover:to-pink-700 text-white px-4 py-2 rounded-lg transition-all duration-300 transform hover:scale-105">
                        ğŸ—‘ï¸ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù†
                    </button>
                    <button onclick="setToday()" class="bg-gradient-to-r from-green-500 to-teal-600 hover:from-green-600 hover:to-teal-700 text-white px-4 py-2 rounded-lg transition-all duration-300 transform hover:scale-105">
                        ğŸ“… Ø§Ù…Ø±ÙˆØ²
                    </button>
                </div>
            </div>

            <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ùˆ Ø¢Ù…Ø§Ø± -->
            <div class="bg-white/10 backdrop-blur-md rounded-2xl p-6 shadow-2xl border border-white/20">
                <h2 class="text-2xl font-bold text-white mb-6">ğŸ“Š Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ùˆ Ø¹Ù…Ù„Ú©Ø±Ø¯</h2>
                
                <div class="space-y-4">
                    <div class="bg-white/20 rounded-lg p-4">
                        <h3 class="text-white font-semibold mb-2">âœ… ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§:</h3>
                        <ul class="text-white/90 text-sm space-y-1">
                            <li>â€¢ Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ Ù†Ø±Ù… Ùˆ Ø¬Ø°Ø§Ø¨</li>
                            <li>â€¢ Ø§Ø³Ú©Ø±ÙˆÙ„ infinite Ø¨Ø±Ø§ÛŒ Ø³Ø§Ù„â€ŒÙ‡Ø§</li>
                            <li>â€¢ ØªØ´Ø®ÛŒØµ Ø³Ø§Ù„ Ú©Ø¨ÛŒØ³Ù‡</li>
                            <li>â€¢ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² ØªØ§Ú† Ùˆ Ø§Ø³Ú©Ø±ÙˆÙ„</li>
                            <li>â€¢ Responsive design</li>
                            <li>â€¢ Ø¨Ø¯ÙˆÙ† ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒ Ø¨Ù‡ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ø®Ø§Ø±Ø¬ÛŒ</li>
                        </ul>
                    </div>
                    
                    <div class="bg-white/20 rounded-lg p-4">
                        <h3 class="text-white font-semibold mb-2">âš¡ Ø¹Ù…Ù„Ú©Ø±Ø¯:</h3>
                        <div id="performanceInfo" class="text-white/90 text-sm">
                            <div>Ø²Ù…Ø§Ù† Ù„ÙˆØ¯: <span id="loadTime">0ms</span></div>
                            <div>ØªØ¹Ø¯Ø§Ø¯ Ø§Ø³ØªÙØ§Ø¯Ù‡: <span id="usageCount">0</span></div>
                            <div>Ø¢Ø®Ø±ÛŒÙ† Ø§Ù†ØªØ®Ø§Ø¨: <span id="lastSelection">-</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ù†ØªØ§ÛŒØ¬ -->
        <div class="bg-white/10 backdrop-blur-md rounded-2xl p-6 shadow-2xl border border-white/20">
            <h2 class="text-2xl font-bold text-white mb-4">ğŸ“‹ Ù†ØªØ§ÛŒØ¬ Ø§Ù†ØªØ®Ø§Ø¨</h2>
            <div id="results" class="bg-black/20 rounded-lg p-4 text-white font-mono text-sm min-h-[100px]">
                Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ ØªØ§Ø±ÛŒØ®...
            </div>
        </div>
    </div>

    <!-- Modal Picker -->
    <div id="pickerOverlay" class="fixed inset-0 bg-black/50 hidden z-50 flex items-center justify-center p-4">
        <div id="pickerModal" class="bg-white rounded-2xl shadow-2xl max-w-md w-full picker-slide-up">
            <!-- Ù‡Ø¯Ø± -->
            <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white p-4 rounded-t-2xl">
                <h3 class="text-xl font-bold text-center">Ø§Ù†ØªØ®Ø§Ø¨ ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ</h3>
                <p class="text-center opacity-90 text-sm mt-1">ØªØ§Ø±ÛŒØ® Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</p>
            </div>
            
            <!-- Ø¨Ø¯Ù†Ù‡ -->
            <div class="p-6">
                <!-- Ù†Ù…Ø§ÛŒØ´ ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡ -->
                <div class="bg-gradient-to-r from-gray-100 to-gray-200 rounded-lg p-4 mb-6 text-center">
                    <div class="text-2xl font-bold text-gray-800" id="selectedDateDisplay">
                        20 Ø´Ù‡Ø±ÛŒÙˆØ± 1403
                    </div>
                    <div class="text-sm text-gray-600" id="selectedDateGregorian">
                        11 September 2024
                    </div>
                </div>
                
                <!-- Ù¾ÛŒÚ©Ø±Ù‡Ø§ -->
                <div class="flex gap-4 justify-center">
                    <!-- Ø³Ø§Ù„ -->
                    <div class="text-center flex-1">
                        <h4 class="font-semibold text-gray-700 mb-2">Ø³Ø§Ù„</h4>
                        <div class="h-40 overflow-y-auto custom-scroll border border-gray-200 rounded-lg scroll-fade">
                            <div id="yearPicker" class="p-2">
                                <!-- Ø³Ø§Ù„â€ŒÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ù…Ø§Ù‡ -->
                    <div class="text-center flex-1">
                        <h4 class="font-semibold text-gray-700 mb-2">Ù…Ø§Ù‡</h4>
                        <div class="h-40 overflow-y-auto custom-scroll border border-gray-200 rounded-lg scroll-fade">
                            <div id="monthPicker" class="p-2">
                                <!-- Ù…Ø§Ù‡â€ŒÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ø±ÙˆØ² -->
                    <div class="text-center flex-1">
                        <h4 class="font-semibold text-gray-700 mb-2">Ø±ÙˆØ²</h4>
                        <div class="h-40 overflow-y-auto custom-scroll border border-gray-200 rounded-lg scroll-fade">
                            <div id="dayPicker" class="p-2">
                                <!-- Ø±ÙˆØ²Ù‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ÙÙˆØªØ± -->
            <div class="flex gap-3 p-4 bg-gray-50 rounded-b-2xl">
                <button onclick="confirmSelection()" 
                        class="flex-1 bg-gradient-to-r from-green-500 to-teal-600 hover:from-green-600 hover:to-teal-700 text-white py-2 px-4 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105">
                    âœ… ØªØ£ÛŒÛŒØ¯
                </button>
                <button onclick="closePicker()" 
                        class="flex-1 bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white py-2 px-4 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105">
                    âŒ Ø§Ù†ØµØ±Ø§Ù
                </button>
            </div>
        </div>
    </div>

    <script>
        // Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø³Ø±Ø§Ø³Ø±ÛŒ
        let currentInput = null;
        let selectedDate = {
            year: 1403,
            month: 6,
            day: 20
        };
        let usageCount = 0;
        const startTime = performance.now();

        // Ø§Ø³Ø§Ù…ÛŒ Ù…Ø§Ù‡â€ŒÙ‡Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ
        const persianMonths = [
            'ÙØ±ÙˆØ±Ø¯ÛŒÙ†', 'Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', 'Ø®Ø±Ø¯Ø§Ø¯', 'ØªÛŒØ±', 'Ù…Ø±Ø¯Ø§Ø¯', 'Ø´Ù‡Ø±ÛŒÙˆØ±',
            'Ù…Ù‡Ø±', 'Ø¢Ø¨Ø§Ù†', 'Ø¢Ø°Ø±', 'Ø¯ÛŒ', 'Ø¨Ù‡Ù…Ù†', 'Ø§Ø³ÙÙ†Ø¯'
        ];

        // Ø§Ø³Ø§Ù…ÛŒ Ø±ÙˆØ²Ù‡Ø§ÛŒ Ù‡ÙØªÙ‡
        const persianWeekdays = [
            'Ø´Ù†Ø¨Ù‡', 'ÛŒÚ©Ø´Ù†Ø¨Ù‡', 'Ø¯ÙˆØ´Ù†Ø¨Ù‡', 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡', 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡', 'Ù¾Ù†Ø¬Ø´Ù†Ø¨Ù‡', 'Ø¬Ù…Ø¹Ù‡'
        ];

        // ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ Ø¨Ù‡ Ù…ÛŒÙ„Ø§Ø¯ÛŒ (ØªÙ‚Ø±ÛŒØ¨ÛŒ)
        function jalaliToGregorian(jYear, jMonth, jDay) {
            // ØªØ¨Ø¯ÛŒÙ„ Ø³Ø§Ø¯Ù‡ - Ø¨Ø±Ø§ÛŒ Ø¯Ù…Ùˆ
            const gYear = jYear + 621;
            const gMonth = jMonth;
            const gDay = jDay;
            return new Date(gYear, gMonth - 1, gDay);
        }

        // ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ Ø¨Ù‡ Ø´Ù…Ø³ÛŒ (ØªÙ‚Ø±ÛŒØ¨ÛŒ)
        function gregorianToJalali(gDate) {
            const jYear = gDate.getFullYear() - 621;
            const jMonth = gDate.getMonth() + 1;
            const jDay = gDate.getDate();
            return { year: jYear, month: jMonth, day: jDay };
        }

        // Ú†Ú© Ú©Ø±Ø¯Ù† Ø³Ø§Ù„ Ú©Ø¨ÛŒØ³Ù‡
        function isLeapYear(year) {
            const cycle = year % 128;
            const yearCycle = cycle % 33;
            return [1, 5, 9, 13, 17, 22, 26, 30].includes(yearCycle);
        }

        // ØªØ¹Ø¯Ø§Ø¯ Ø±ÙˆØ²Ù‡Ø§ÛŒ Ù…Ø§Ù‡
        function getDaysInMonth(year, month) {
            if (month <= 6) return 31;
            if (month <= 11) return 30;
            return isLeapYear(year) ? 30 : 29;
        }

        // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ picker
        function initPicker() {
            // Ø³Ø§Ù„â€ŒÙ‡Ø§
            const yearPicker = document.getElementById('yearPicker');
            yearPicker.innerHTML = '';
            for (let year = 1350; year <= 1450; year++) {
                const div = document.createElement('div');
                div.className = `picker-item-highlight cursor-pointer py-2 px-3 rounded-lg transition-all duration-200 hover:bg-blue-100 ${year === selectedDate.year ? 'bg-blue-500 text-white' : 'text-gray-700'}`;
                div.textContent = year;
                div.onclick = () => selectYear(year);
                yearPicker.appendChild(div);
            }

            // Ù…Ø§Ù‡â€ŒÙ‡Ø§
            const monthPicker = document.getElementById('monthPicker');
            monthPicker.innerHTML = '';
            persianMonths.forEach((month, index) => {
                const div = document.createElement('div');
                div.className = `picker-item-highlight cursor-pointer py-2 px-3 rounded-lg transition-all duration-200 hover:bg-blue-100 ${index + 1 === selectedDate.month ? 'bg-blue-500 text-white' : 'text-gray-700'}`;
                div.textContent = month;
                div.onclick = () => selectMonth(index + 1);
                monthPicker.appendChild(div);
            });

            updateDays();
            updateDisplay();
        }

        // Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø§Ù„
        function selectYear(year) {
            selectedDate.year = year;
            updateDays();
            updateDisplay();
            
            // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§
            document.querySelectorAll('#yearPicker div').forEach(el => {
                el.className = `picker-item-highlight cursor-pointer py-2 px-3 rounded-lg transition-all duration-200 hover:bg-blue-100 ${parseInt(el.textContent) === year ? 'bg-blue-500 text-white' : 'text-gray-700'}`;
            });
        }

        // Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ø§Ù‡
        function selectMonth(month) {
            selectedDate.month = month;
            updateDays();
            updateDisplay();
            
            // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§
            document.querySelectorAll('#monthPicker div').forEach((el, index) => {
                el.className = `picker-item-highlight cursor-pointer py-2 px-3 rounded-lg transition-all duration-200 hover:bg-blue-100 ${index + 1 === month ? 'bg-blue-500 text-white' : 'text-gray-700'}`;
            });
        }

        // Ø§Ù†ØªØ®Ø§Ø¨ Ø±ÙˆØ²
        function selectDay(day) {
            selectedDate.day = day;
            updateDisplay();
            
            // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§
            document.querySelectorAll('#dayPicker div').forEach(el => {
                el.className = `picker-item-highlight cursor-pointer py-2 px-3 rounded-lg transition-all duration-200 hover:bg-blue-100 ${parseInt(el.textContent) === day ? 'bg-blue-500 text-white' : 'text-gray-700'}`;
            });
        }

        // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø±ÙˆØ²Ù‡Ø§
        function updateDays() {
            const dayPicker = document.getElementById('dayPicker');
            dayPicker.innerHTML = '';
            
            const daysInMonth = getDaysInMonth(selectedDate.year, selectedDate.month);
            
            // Ø§ØµÙ„Ø§Ø­ Ø±ÙˆØ² Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡ Ø§Ú¯Ø± Ø¨ÛŒØ´ØªØ± Ø§Ø² Ø±ÙˆØ²Ù‡Ø§ÛŒ Ù…Ø§Ù‡ Ø¨Ø§Ø´Ø¯
            if (selectedDate.day > daysInMonth) {
                selectedDate.day = daysInMonth;
            }
            
            for (let day = 1; day <= daysInMonth; day++) {
                const div = document.createElement('div');
                div.className = `picker-item-highlight cursor-pointer py-2 px-3 rounded-lg transition-all duration-200 hover:bg-blue-100 ${day === selectedDate.day ? 'bg-blue-500 text-white' : 'text-gray-700'}`;
                div.textContent = day;
                div.onclick = () => selectDay(day);
                dayPicker.appendChild(div);
            }
        }

        // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´
        function updateDisplay() {
            const persianDate = `${selectedDate.day} ${persianMonths[selectedDate.month - 1]} ${selectedDate.year}`;
            const gregorianDate = jalaliToGregorian(selectedDate.year, selectedDate.month, selectedDate.day);
            const gregorianFormatted = gregorianDate.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });

            document.getElementById('selectedDateDisplay').textContent = persianDate;
            document.getElementById('selectedDateGregorian').textContent = gregorianFormatted;
        }

        // Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† picker
        function openPicker(input) {
            currentInput = input;
            initPicker();
            document.getElementById('pickerOverlay').classList.remove('hidden');
            
            // Ø§Ù†ÛŒÙ…ÛŒØ´Ù†
            const modal = document.getElementById('pickerModal');
            modal.classList.remove('picker-slide-down');
            modal.classList.add('picker-slide-up');
            
            updatePerformanceInfo();
        }

        // Ø¨Ø³ØªÙ† picker
        function closePicker() {
            const modal = document.getElementById('pickerModal');
            modal.classList.remove('picker-slide-up');
            modal.classList.add('picker-slide-down');
            
            setTimeout(() => {
                document.getElementById('pickerOverlay').classList.add('hidden');
            }, 300);
        }

        // ØªØ£ÛŒÛŒØ¯ Ø§Ù†ØªØ®Ø§Ø¨
        function confirmSelection() {
            if (currentInput) {
                const persianDate = `${selectedDate.day} ${persianMonths[selectedDate.month - 1]} ${selectedDate.year}`;
                const isoDate = `${selectedDate.year}/${selectedDate.month.toString().padStart(2, '0')}/${selectedDate.day.toString().padStart(2, '0')}`;
                
                currentInput.value = persianDate;
                currentInput.dataset.date = isoDate;
                
                usageCount++;
                updateResults(`âœ… ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯: ${persianDate} (${isoDate})`);
                updatePerformanceInfo();
            }
            closePicker();
        }

        // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¹Ù…Ù„Ú©Ø±Ø¯
        function updatePerformanceInfo() {
            document.getElementById('loadTime').textContent = `${(performance.now() - startTime).toFixed(2)}ms`;
            document.getElementById('usageCount').textContent = usageCount;
            document.getElementById('lastSelection').textContent = new Date().toLocaleTimeString('fa-IR');
        }

        // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†ØªØ§ÛŒØ¬
        function updateResults(message) {
            const results = document.getElementById('results');
            const timestamp = new Date().toLocaleTimeString('fa-IR');
            results.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            results.scrollTop = results.scrollHeight;
        }

        // Ù†Ù…Ø§ÛŒØ´ Ø¯Ù…Ùˆ
        function showDemo() {
            openPicker(document.getElementById('birthDate'));
        }

        // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡
        function clearAll() {
            document.getElementById('birthDate').value = '';
            document.getElementById('workDate').value = '';
            document.getElementById('birthDate').dataset.date = '';
            document.getElementById('workDate').dataset.date = '';
            updateResults('ğŸ—‘ï¸ Ù‡Ù…Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯');
        }

        // ØªÙ†Ø¸ÛŒÙ… ØªØ§Ø±ÛŒØ® Ø§Ù…Ø±ÙˆØ²
        function setToday() {
            const today = new Date();
            const jalaliToday = gregorianToJalali(today);
            selectedDate = jalaliToday;
            
            const persianDate = `${jalaliToday.day} ${persianMonths[jalaliToday.month - 1]} ${jalaliToday.year}`;
            const isoDate = `${jalaliToday.year}/${jalaliToday.month.toString().padStart(2, '0')}/${jalaliToday.day.toString().padStart(2, '0')}`;
            
            document.getElementById('birthDate').value = persianDate;
            document.getElementById('birthDate').dataset.date = isoDate;
            
            updateResults(`ğŸ“… ØªØ§Ø±ÛŒØ® Ø§Ù…Ø±ÙˆØ² ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯: ${persianDate}`);
        }

        // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        document.addEventListener('DOMContentLoaded', function() {
            // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† event listener Ù‡Ø§
            document.getElementById('birthDate').onclick = (e) => openPicker(e.target);
            document.getElementById('workDate').onclick = (e) => openPicker(e.target);
            
            // Ø¨Ø³ØªÙ† Ø¨Ø§ Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ overlay
            document.getElementById('pickerOverlay').onclick = (e) => {
                if (e.target === e.currentTarget) {
                    closePicker();
                }
            };
            
            // Ú©Ù„ÛŒØ¯Ù‡Ø§ÛŒ Ù…ÛŒØ§Ù†Ø¨Ø±
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closePicker();
                }
            });
            
            updatePerformanceInfo();
            updateResults('ğŸš€ Scrolling Jalali Picker Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¢Ù…Ø§Ø¯Ù‡ Ø´Ø¯!');
            updateResults('ğŸ’¡ Ø±ÙˆÛŒ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ ØªØ§Ø±ÛŒØ® Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ØªØ§ picker Ø¨Ø§Ø² Ø´ÙˆØ¯');
        });
    </script>
</body>
</html>
