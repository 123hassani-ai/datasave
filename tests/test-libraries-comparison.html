<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تست کتابخانه‌های دیت پیکر فارسی</title>
    
    <!-- فونت وزیرمتن -->
    <link href="assets/fonts/vazirmatn.css" rel="stylesheet">
    
    <!-- Persian DatePicker CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/persian-datepicker@1.2.0/dist/css/persian-datepicker.min.css">
    
    <!-- Persian Date CSS -->
    <link rel="stylesheet" href="https://unpkg.com/persian-date@1.1.0/dist/persian-date.min.css">
    
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Vazirmatn', 'Tahoma', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .test-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
            transition: transform 0.3s ease;
        }
        
        .test-card:hover {
            transform: translateY(-5px);
        }
        
        .test-card h2 {
            color: white;
            font-size: 1.5rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .test-card .badge {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: white;
            font-weight: 600;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px 16px;
            border: none;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.9);
            font-family: 'Vazirmatn', sans-serif;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus {
            outline: none;
            background: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-family: 'Vazirmatn', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
            font-size: 13px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn.success {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
        }
        
        .btn.danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }
        
        .output {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            font-family: monospace;
            font-size: 12px;
            max-height: 150px;
            overflow-y: auto;
        }
        
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 600;
            margin: 2px 0;
        }
        
        .status.loading {
            background: #f39c12;
            color: white;
        }
        
        .status.success {
            background: #2ecc71;
            color: white;
        }
        
        .status.error {
            background: #e74c3c;
            color: white;
        }
        
        .comparison {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
            margin-top: 30px;
        }
        
        .comparison h2 {
            color: white;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .comparison-item {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 10px;
            color: white;
            text-align: center;
        }
        
        .comparison-item h3 {
            color: #f39c12;
            margin-bottom: 10px;
            font-size: 1rem;
        }
        
        .comparison-item .score {
            font-size: 2rem;
            font-weight: bold;
            color: #2ecc71;
        }
        
        .comparison-item .details {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🗓️ تست کتابخانه‌های دیت پیکر فارسی</h1>
            <p>مقایسه و تست بهترین کتابخانه‌های تاریخ شمسی JavaScript</p>
        </div>

        <div class="test-grid">
            <!-- تست Persian DatePicker -->
            <div class="test-card">
                <h2>
                    Persian DatePicker
                    <span class="badge">محبوب</span>
                </h2>
                <div class="form-group">
                    <label>تاریخ شروع:</label>
                    <input type="text" id="persianDatePicker1" placeholder="انتخاب تاریخ...">
                </div>
                <div class="form-group">
                    <label>تاریخ پایان:</label>
                    <input type="text" id="persianDatePicker2" placeholder="انتخاب تاریخ...">
                </div>
                <button class="btn" onclick="testPersianDatePicker()">تست عملکرد</button>
                <button class="btn success" onclick="clearPersianDatePicker()">پاک کردن</button>
                <div class="output" id="persianDatePickerOutput">
                    <span class="status loading">در حال بارگذاری...</span>
                </div>
            </div>

            <!-- تست Persian Date -->
            <div class="test-card">
                <h2>
                    Persian Date
                    <span class="badge">سبک</span>
                </h2>
                <div class="form-group">
                    <label>تاریخ شروع:</label>
                    <input type="text" id="persianDate1" placeholder="انتخاب تاریخ...">
                </div>
                <div class="form-group">
                    <label>تاریخ پایان:</label>
                    <input type="text" id="persianDate2" placeholder="انتخاب تاریخ...">
                </div>
                <button class="btn" onclick="testPersianDate()">تست عملکرد</button>
                <button class="btn success" onclick="clearPersianDate()">پاک کردن</button>
                <div class="output" id="persianDateOutput">
                    <span class="status loading">در حال بارگذاری...</span>
                </div>
            </div>

            <!-- تست Moment.js Persian -->
            <div class="test-card">
                <h2>
                    Moment.js + جلالی
                    <span class="badge">قدرتمند</span>
                </h2>
                <div class="form-group">
                    <label>تاریخ شروع:</label>
                    <input type="text" id="momentPersian1" placeholder="انتخاب تاریخ...">
                </div>
                <div class="form-group">
                    <label>تاریخ پایان:</label>
                    <input type="text" id="momentPersian2" placeholder="انتخاب تاریخ...">
                </div>
                <button class="btn" onclick="testMomentPersian()">تست عملکرد</button>
                <button class="btn success" onclick="clearMomentPersian()">پاک کردن</button>
                <div class="output" id="momentPersianOutput">
                    <span class="status loading">در حال بارگذاری...</span>
                </div>
            </div>

            <!-- تست DatePicker Custom -->
            <div class="test-card">
                <h2>
                    DatePicker سفارشی
                    <span class="badge">سازگار</span>
                </h2>
                <div class="form-group">
                    <label>تاریخ شروع:</label>
                    <input type="text" id="customDatePicker1" placeholder="انتخاب تاریخ...">
                </div>
                <div class="form-group">
                    <label>تاریخ پایان:</label>
                    <input type="text" id="customDatePicker2" placeholder="انتخاب تاریخ...">
                </div>
                <button class="btn" onclick="testCustomDatePicker()">تست عملکرد</button>
                <button class="btn success" onclick="clearCustomDatePicker()">پاک کردن</button>
                <div class="output" id="customDatePickerOutput">
                    <span class="status loading">در حال بارگذاری...</span>
                </div>
            </div>
        </div>

        <!-- مقایسه نتایج -->
        <div class="comparison">
            <h2>📊 نتایج مقایسه</h2>
            <div class="comparison-grid" id="comparisonResults">
                <!-- نتایج به صورت داینامیک اضافه می‌شوند -->
            </div>
        </div>
    </div>

    <!-- کتابخانه‌ها -->
    
    <!-- jQuery (مورد نیاز برای Persian DatePicker) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <!-- Persian DatePicker -->
    <script src="https://cdn.jsdelivr.net/npm/persian-datepicker@1.2.0/dist/js/persian-datepicker.min.js"></script>
    
    <!-- Persian Date -->
    <script src="https://unpkg.com/persian-date@1.1.0/dist/persian-date.min.js"></script>
    
    <!-- Moment.js + Jalali -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment-jalaali/0.10.0/moment-jalaali.min.js"></script>
    
    <script>
        // متغیرهای سراسری برای ذخیره نتایج تست
        const testResults = {
            persianDatePicker: { loaded: false, working: false, performance: 0, features: 0 },
            persianDate: { loaded: false, working: false, performance: 0, features: 0 },
            momentPersian: { loaded: false, working: false, performance: 0, features: 0 },
            customDatePicker: { loaded: false, working: false, performance: 0, features: 0 }
        };

        // تابع کمکی برای نمایش خروجی
        function showOutput(elementId, message, status = 'success') {
            const output = document.getElementById(elementId);
            const timestamp = new Date().toLocaleTimeString('fa-IR');
            const statusClass = status === 'error' ? 'error' : status === 'loading' ? 'loading' : 'success';
            
            output.innerHTML += `
                <div><span class="status ${statusClass}">[${timestamp}]</span> ${message}</div>
            `;
            output.scrollTop = output.scrollHeight;
        }

        // بررسی بارگذاری کتابخانه‌ها
        function checkLibraries() {
            // بررسی Persian DatePicker
            if (typeof $ !== 'undefined' && $.fn.persianDatepicker) {
                testResults.persianDatePicker.loaded = true;
                showOutput('persianDatePickerOutput', '✅ کتابخانه Persian DatePicker بارگذاری شد', 'success');
            } else {
                showOutput('persianDatePickerOutput', '❌ خطا در بارگذاری Persian DatePicker', 'error');
            }

            // بررسی Persian Date
            if (typeof PersianDate !== 'undefined') {
                testResults.persianDate.loaded = true;
                showOutput('persianDateOutput', '✅ کتابخانه Persian Date بارگذاری شد', 'success');
            } else {
                showOutput('persianDateOutput', '❌ خطا در بارگذاری Persian Date', 'error');
            }

            // بررسی Moment.js Persian
            if (typeof moment !== 'undefined' && moment.loadPersian) {
                moment.loadPersian();
                testResults.momentPersian.loaded = true;
                showOutput('momentPersianOutput', '✅ کتابخانه Moment.js + جلالی بارگذاری شد', 'success');
            } else {
                showOutput('momentPersianOutput', '❌ خطا در بارگذاری Moment.js + جلالی', 'error');
            }

            // DatePicker سفارشی همیشه در دسترس است
            testResults.customDatePicker.loaded = true;
            showOutput('customDatePickerOutput', '✅ DatePicker سفارشی آماده است', 'success');
        }

        // راه اندازی Persian DatePicker
        function initPersianDatePicker() {
            if (testResults.persianDatePicker.loaded) {
                try {
                    $('#persianDatePicker1, #persianDatePicker2').persianDatepicker({
                        format: 'YYYY/MM/DD',
                        initialValue: false,
                        autoClose: true,
                        calendar: {
                            persian: {
                                locale: 'fa'
                            }
                        }
                    });
                    testResults.persianDatePicker.working = true;
                    testResults.persianDatePicker.features = 8; // امتیاز ویژگی
                    showOutput('persianDatePickerOutput', '🎯 Persian DatePicker راه‌اندازی شد', 'success');
                } catch (error) {
                    showOutput('persianDatePickerOutput', `❌ خطا در راه‌اندازی: ${error.message}`, 'error');
                }
            }
        }

        // راه اندازی Persian Date
        function initPersianDate() {
            if (testResults.persianDate.loaded) {
                try {
                    // ایجاد یک تاریخ نمونه
                    const persianDate = new PersianDate();
                    const formatted = persianDate.format('YYYY/MM/DD');
                    
                    testResults.persianDate.working = true;
                    testResults.persianDate.features = 6; // امتیاز ویژگی
                    showOutput('persianDateOutput', `🎯 Persian Date راه‌اندازی شد: ${formatted}`, 'success');
                } catch (error) {
                    showOutput('persianDateOutput', `❌ خطا در راه‌اندازی: ${error.message}`, 'error');
                }
            }
        }

        // راه اندازی Moment.js Persian
        function initMomentPersian() {
            if (testResults.momentPersian.loaded) {
                try {
                    const now = moment().format('jYYYY/jMM/jDD');
                    testResults.momentPersian.working = true;
                    testResults.momentPersian.features = 9; // امتیاز ویژگی
                    showOutput('momentPersianOutput', `🎯 Moment.js Persian راه‌اندازی شد: ${now}`, 'success');
                } catch (error) {
                    showOutput('momentPersianOutput', `❌ خطا در راه‌اندازی: ${error.message}`, 'error');
                }
            }
        }

        // راه اندازی DatePicker سفارشی
        function initCustomDatePicker() {
            try {
                // پیاده‌سازی ساده DatePicker سفارشی
                const inputs = document.querySelectorAll('#customDatePicker1, #customDatePicker2');
                inputs.forEach(input => {
                    input.addEventListener('focus', function() {
                        // شبیه‌سازی DatePicker
                        const today = new Date();
                        const persianToday = `${today.getFullYear() - 621}/${String(today.getMonth() + 1).padStart(2, '0')}/${String(today.getDate()).padStart(2, '0')}`;
                        this.value = persianToday;
                    });
                });
                
                testResults.customDatePicker.working = true;
                testResults.customDatePicker.features = 4; // امتیاز ویژگی
                showOutput('customDatePickerOutput', '🎯 DatePicker سفارشی راه‌اندازی شد', 'success');
            } catch (error) {
                showOutput('customDatePickerOutput', `❌ خطا در راه‌اندازی: ${error.message}`, 'error');
            }
        }

        // تست عملکرد Persian DatePicker
        function testPersianDatePicker() {
            const start = performance.now();
            try {
                const val1 = $('#persianDatePicker1').val();
                const val2 = $('#persianDatePicker2').val();
                const end = performance.now();
                
                testResults.persianDatePicker.performance = end - start;
                showOutput('persianDatePickerOutput', `📊 تست عملکرد: ${(end - start).toFixed(2)}ms`);
                showOutput('persianDatePickerOutput', `📅 مقادیر: شروع="${val1}" پایان="${val2}"`);
                
                updateComparison();
            } catch (error) {
                showOutput('persianDatePickerOutput', `❌ خطا در تست: ${error.message}`, 'error');
            }
        }

        // تست عملکرد Persian Date
        function testPersianDate() {
            const start = performance.now();
            try {
                const date1 = new PersianDate().format('YYYY/MM/DD');
                const date2 = new PersianDate().add('day', 7).format('YYYY/MM/DD');
                const end = performance.now();
                
                document.getElementById('persianDate1').value = date1;
                document.getElementById('persianDate2').value = date2;
                
                testResults.persianDate.performance = end - start;
                showOutput('persianDateOutput', `📊 تست عملکرد: ${(end - start).toFixed(2)}ms`);
                showOutput('persianDateOutput', `📅 مقادیر: شروع="${date1}" پایان="${date2}"`);
                
                updateComparison();
            } catch (error) {
                showOutput('persianDateOutput', `❌ خطا در تست: ${error.message}`, 'error');
            }
        }

        // تست عملکرد Moment.js Persian
        function testMomentPersian() {
            const start = performance.now();
            try {
                const date1 = moment().format('jYYYY/jMM/jDD');
                const date2 = moment().add(7, 'days').format('jYYYY/jMM/jDD');
                const end = performance.now();
                
                document.getElementById('momentPersian1').value = date1;
                document.getElementById('momentPersian2').value = date2;
                
                testResults.momentPersian.performance = end - start;
                showOutput('momentPersianOutput', `📊 تست عملکرد: ${(end - start).toFixed(2)}ms`);
                showOutput('momentPersianOutput', `📅 مقادیر: شروع="${date1}" پایان="${date2}"`);
                
                updateComparison();
            } catch (error) {
                showOutput('momentPersianOutput', `❌ خطا در تست: ${error.message}`, 'error');
            }
        }

        // تست عملکرد DatePicker سفارشی
        function testCustomDatePicker() {
            const start = performance.now();
            try {
                const today = new Date();
                const date1 = `${today.getFullYear() - 621}/${String(today.getMonth() + 1).padStart(2, '0')}/${String(today.getDate()).padStart(2, '0')}`;
                const futureDate = new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000);
                const date2 = `${futureDate.getFullYear() - 621}/${String(futureDate.getMonth() + 1).padStart(2, '0')}/${String(futureDate.getDate()).padStart(2, '0')}`;
                const end = performance.now();
                
                document.getElementById('customDatePicker1').value = date1;
                document.getElementById('customDatePicker2').value = date2;
                
                testResults.customDatePicker.performance = end - start;
                showOutput('customDatePickerOutput', `📊 تست عملکرد: ${(end - start).toFixed(2)}ms`);
                showOutput('customDatePickerOutput', `📅 مقادیر: شروع="${date1}" پایان="${date2}"`);
                
                updateComparison();
            } catch (error) {
                showOutput('customDatePickerOutput', `❌ خطا در تست: ${error.message}`, 'error');
            }
        }

        // توابع پاک کردن
        function clearPersianDatePicker() {
            $('#persianDatePicker1, #persianDatePicker2').val('');
            showOutput('persianDatePickerOutput', '🧹 مقادیر پاک شدند', 'success');
        }

        function clearPersianDate() {
            document.getElementById('persianDate1').value = '';
            document.getElementById('persianDate2').value = '';
            showOutput('persianDateOutput', '🧹 مقادیر پاک شدند', 'success');
        }

        function clearMomentPersian() {
            document.getElementById('momentPersian1').value = '';
            document.getElementById('momentPersian2').value = '';
            showOutput('momentPersianOutput', '🧹 مقادیر پاک شدند', 'success');
        }

        function clearCustomDatePicker() {
            document.getElementById('customDatePicker1').value = '';
            document.getElementById('customDatePicker2').value = '';
            showOutput('customDatePickerOutput', '🧹 مقادیر پاک شدند', 'success');
        }

        // بروزرسانی نتایج مقایسه
        function updateComparison() {
            const comparisonResults = document.getElementById('comparisonResults');
            comparisonResults.innerHTML = '';
            
            Object.keys(testResults).forEach(key => {
                const result = testResults[key];
                const name = key.replace(/([A-Z])/g, ' $1').trim();
                const score = result.loaded && result.working ? 
                    Math.round((result.features * 10) - (result.performance / 10)) : 0;
                
                comparisonResults.innerHTML += `
                    <div class="comparison-item">
                        <h3>${name}</h3>
                        <div class="score">${score}</div>
                        <div class="details">
                            ${result.loaded ? '✅ بارگذاری شد' : '❌ بارگذاری نشد'}<br>
                            ${result.working ? '✅ کار می‌کند' : '❌ کار نمی‌کند'}<br>
                            عملکرد: ${result.performance.toFixed(2)}ms<br>
                            ویژگی‌ها: ${result.features}/10
                        </div>
                    </div>
                `;
            });
        }

        // راه اندازی اولیه
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                checkLibraries();
                setTimeout(() => {
                    initPersianDatePicker();
                    initPersianDate();
                    initMomentPersian();
                    initCustomDatePicker();
                    updateComparison();
                }, 1000);
            }, 500);
        });
    </script>
</body>
</html>
