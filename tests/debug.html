<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ Ø³ÛŒØ³ØªÙ… Ù„Ø§Ú¯â€ŒÚ¯ÛŒØ±ÛŒ - DataSave</title>
    <style>
        body { 
            font-family: Tahoma, Arial, sans-serif; 
            padding: 20px; 
            direction: rtl;
            background: #f5f5f5;
        }
        .debug-box {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            border-right: 5px solid #007bff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .status {
            padding: 8px 12px;
            border-radius: 4px;
            margin: 5px 0;
            font-weight: bold;
        }
        .status.success { background: #d4edda; color: #155724; }
        .status.error { background: #f8d7da; color: #721c24; }
        .status.warning { background: #fff3cd; color: #856404; }
        .status.info { background: #d1ecf1; color: #0c5460; }
        
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
        }
        button:hover { background: #0056b3; }
        .error-btn { background: #dc3545; }
        .error-btn:hover { background: #c82333; }
        
        .log-output {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            max-height: 300px;
            overflow-y: auto;
            direction: ltr;
        }
        
        .step {
            counter-increment: step-counter;
            margin: 10px 0;
            padding-right: 30px;
            position: relative;
        }
        .step::before {
            content: counter(step-counter);
            position: absolute;
            right: 0;
            top: 0;
            background: #007bff;
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        .container { 
            max-width: 1000px; 
            margin: 0 auto; 
            counter-reset: step-counter;
        }
        
        h1 { 
            color: #343a40; 
            text-align: center; 
            margin-bottom: 30px;
        }
        h2 { 
            color: #495057; 
            border-bottom: 2px solid #007bff; 
            padding-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ Ø³ÛŒØ³ØªÙ… Ù„Ø§Ú¯â€ŒÚ¯ÛŒØ±ÛŒ DataSave</h1>
        
        <!-- Ù…Ø±Ø­Ù„Ù‡ Û±: Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ -->
        <div class="debug-box">
            <h2>Ù…Ø±Ø­Ù„Ù‡ Û±: Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§</h2>
            <div class="step">
                <strong>Ø¨Ø±Ø±Ø³ÛŒ logging.js:</strong>
                <div id="loggingModuleStatus" class="status info">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ...</div>
            </div>
            <div class="step">
                <strong>Ø¨Ø±Ø±Ø³ÛŒ Logger instance:</strong>
                <div id="loggerInstanceStatus" class="status info">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ...</div>
            </div>
            <div class="step">
                <strong>Ø¨Ø±Ø±Ø³ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª:</strong>
                <div id="configStatus" class="status info">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ...</div>
            </div>
        </div>

        <!-- Ù…Ø±Ø­Ù„Ù‡ Û²: ØªØ³Øª Ø§ØªØµØ§Ù„ Ø³Ø±ÙˆØ± -->
        <div class="debug-box">
            <h2>Ù…Ø±Ø­Ù„Ù‡ Û²: ØªØ³Øª Ø§ØªØµØ§Ù„ Ø³Ø±ÙˆØ±</h2>
            <div class="step">
                <strong>ØªØ³Øª API logging:</strong>
                <div id="apiTestStatus" class="status info">Ø¢Ù…Ø§Ø¯Ù‡ ØªØ³Øª</div>
                <button onclick="testLoggingAPI()">ØªØ³Øª API</button>
            </div>
            <div class="step">
                <strong>ØªØ³Øª Ø§Ø±Ø³Ø§Ù„ Ù„Ø§Ú¯:</strong>
                <div id="sendLogStatus" class="status info">Ø¢Ù…Ø§Ø¯Ù‡ ØªØ³Øª</div>
                <button onclick="testSendLog()">Ø§Ø±Ø³Ø§Ù„ Ù„Ø§Ú¯ ØªØ³Øª</button>
            </div>
        </div>

        <!-- Ù…Ø±Ø­Ù„Ù‡ Û³: ØªØ³Øª Ø®Ø·Ø§Ù‡Ø§ÛŒ JavaScript -->
        <div class="debug-box">
            <h2>Ù…Ø±Ø­Ù„Ù‡ Û³: ØªØ³Øª Ø®Ø·Ø§Ù‡Ø§ÛŒ JavaScript</h2>
            <div class="step">
                <strong>ØªØ³Øª global error handler:</strong>
                <div id="globalErrorStatus" class="status info">Ø¢Ù…Ø§Ø¯Ù‡ ØªØ³Øª</div>
                <button class="error-btn" onclick="testGlobalError()">Ø§ÛŒØ¬Ø§Ø¯ Ø®Ø·Ø§ÛŒ JavaScript</button>
            </div>
            <div class="step">
                <strong>ØªØ³Øª Promise rejection:</strong>
                <div id="promiseErrorStatus" class="status info">Ø¢Ù…Ø§Ø¯Ù‡ ØªØ³Øª</div>
                <button class="error-btn" onclick="testPromiseError()">Ø§ÛŒØ¬Ø§Ø¯ Promise Error</button>
            </div>
            <div class="step">
                <strong>ØªØ³Øª Logger.error():</strong>
                <div id="loggerErrorStatus" class="status info">Ø¢Ù…Ø§Ø¯Ù‡ ØªØ³Øª</div>
                <button class="error-btn" onclick="testLoggerError()">Ø§Ø±Ø³Ø§Ù„ Ø®Ø·Ø§ Ø§Ø² Logger</button>
            </div>
        </div>

        <!-- Ù…Ø±Ø­Ù„Ù‡ Û´: Ø¨Ø±Ø±Ø³ÛŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù„Ø§Ú¯ -->
        <div class="debug-box">
            <h2>Ù…Ø±Ø­Ù„Ù‡ Û´: Ø¨Ø±Ø±Ø³ÛŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù„Ø§Ú¯</h2>
            <div class="step">
                <strong>Ø¯Ø±ÛŒØ§ÙØª Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø³Ø±ÙˆØ±:</strong>
                <div id="serverLogsStatus" class="status info">Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø±Ø³ÛŒ</div>
                <button onclick="checkServerLogs()">Ø¨Ø±Ø±Ø³ÛŒ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø³Ø±ÙˆØ±</button>
            </div>
            <div class="step">
                <strong>Ø¢Ù…Ø§Ø± Ù„Ø§Ú¯â€ŒÙ‡Ø§:</strong>
                <div id="logStatsStatus" class="status info">Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø±Ø³ÛŒ</div>
                <button onclick="getLogStats()">Ø¯Ø±ÛŒØ§ÙØª Ø¢Ù…Ø§Ø±</button>
            </div>
        </div>

        <!-- Ø®Ø±ÙˆØ¬ÛŒ Ù„Ø§Ú¯â€ŒÙ‡Ø§ -->
        <div class="debug-box">
            <h2>Ø®Ø±ÙˆØ¬ÛŒ Ùˆ Ù†ØªØ§ÛŒØ¬</h2>
            <div id="debugOutput" class="log-output">
Ø¢Ù…Ø§Ø¯Ù‡ Ù†Ù…Ø§ÛŒØ´ Ù†ØªØ§ÛŒØ¬...
            </div>
            <button onclick="clearOutput()">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø®Ø±ÙˆØ¬ÛŒ</button>
            <button onclick="exportResults()">Ø®Ø±ÙˆØ¬ÛŒ JSON</button>
        </div>
    </div>

    <!-- Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø³ÛŒØ³ØªÙ… Ù„Ø§Ú¯â€ŒÚ¯ÛŒØ±ÛŒ -->
    <script src="assets/js/modules/logging.js"></script>
    
    <script>
        // Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø¹Ù…ÙˆÙ…ÛŒ Ø¨Ø±Ø§ÛŒ Ù†ØªØ§ÛŒØ¬
        let debugResults = {
            timestamp: new Date().toISOString(),
            tests: {},
            errors: [],
            warnings: [],
            info: []
        };

        function logDebug(message, type = 'info', testName = null) {
            const timestamp = new Date().toLocaleTimeString('fa-IR');
            const output = document.getElementById('debugOutput');
            
            // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ø®Ø±ÙˆØ¬ÛŒ
            output.textContent += `[${timestamp}] ${message}\n`;
            output.scrollTop = output.scrollHeight;
            
            // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Ù†ØªØ§ÛŒØ¬
            debugResults[type].push({
                timestamp,
                message,
                testName
            });
            
            if (testName) {
                debugResults.tests[testName] = { type, message, timestamp };
            }
        }

        function updateStatus(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = `status ${type}`;
        }

        // Ù…Ø±Ø­Ù„Ù‡ Û±: Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§
        function checkModuleLoading() {
            // Ø¨Ø±Ø±Ø³ÛŒ logging.js
            if (typeof window.Logger !== 'undefined') {
                updateStatus('loggingModuleStatus', 'âœ… Ù…Ø§Ú˜ÙˆÙ„ logging.js Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù‡', 'success');
                logDebug('âœ… Ù…Ø§Ú˜ÙˆÙ„ logging.js Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù‡', 'info', 'logging_module');
            } else {
                updateStatus('loggingModuleStatus', 'âŒ Ù…Ø§Ú˜ÙˆÙ„ logging.js Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ø´Ø¯Ù‡', 'error');
                logDebug('âŒ Ù…Ø§Ú˜ÙˆÙ„ logging.js Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ø´Ø¯Ù‡', 'errors', 'logging_module');
                return;
            }

            // Ø¨Ø±Ø±Ø³ÛŒ Logger instance
            if (window.Logger && typeof window.Logger.info === 'function') {
                updateStatus('loggerInstanceStatus', 'âœ… Logger instance ÙØ¹Ø§Ù„ Ø§Ø³Øª', 'success');
                logDebug('âœ… Logger instance ÙØ¹Ø§Ù„ Ø§Ø³Øª', 'info', 'logger_instance');
                
                // ØªØ³Øª Logger
                try {
                    window.Logger.info('ØªØ³Øª Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ', { 
                        debug: true, 
                        timestamp: new Date().toISOString() 
                    });
                    logDebug('âœ… ØªØ³Øª Ø§ÙˆÙ„ÛŒÙ‡ Logger Ù…ÙˆÙÙ‚', 'info', 'logger_test');
                } catch (error) {
                    logDebug(`âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª Ø§ÙˆÙ„ÛŒÙ‡ Logger: ${error.message}`, 'errors', 'logger_test');
                }
            } else {
                updateStatus('loggerInstanceStatus', 'âŒ Logger instance Ù…Ø¹ÛŒÙˆØ¨', 'error');
                logDebug('âŒ Logger instance Ù…Ø¹ÛŒÙˆØ¨', 'errors', 'logger_instance');
            }

            // Ø¨Ø±Ø±Ø³ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
            if (typeof window.LoggingConfig !== 'undefined') {
                updateStatus('configStatus', 'âœ… ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù‡', 'success');
                logDebug(`âœ… ØªÙ†Ø¸ÛŒÙ…Ø§Øª: enableLogging=${window.LoggingConfig.enableLogging}, enableServerLogging=${window.LoggingConfig.performance.enableServerLogging}`, 'info', 'config');
            } else {
                updateStatus('configStatus', 'âŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ø´Ø¯Ù‡', 'error');
                logDebug('âŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ø´Ø¯Ù‡', 'errors', 'config');
            }
        }

        // ØªØ³Øª API
        async function testLoggingAPI() {
            try {
                logDebug('ğŸ”„ Ø´Ø±ÙˆØ¹ ØªØ³Øª API...', 'info', 'api_test_start');
                
                const response = await fetch('./backend/api/v1/logging.php?action=stats', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const result = await response.json();
                    updateStatus('apiTestStatus', 'âœ… API Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ø§Ø³Øª', 'success');
                    logDebug(`âœ… API Ù¾Ø§Ø³Ø® Ø¯Ø§Ø¯: ${JSON.stringify(result)}`, 'info', 'api_test');
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                updateStatus('apiTestStatus', `âŒ Ø®Ø·Ø§ Ø¯Ø± API: ${error.message}`, 'error');
                logDebug(`âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª API: ${error.message}`, 'errors', 'api_test');
            }
        }

        // ØªØ³Øª Ø§Ø±Ø³Ø§Ù„ Ù„Ø§Ú¯
        async function testSendLog() {
            try {
                logDebug('ğŸ”„ Ø´Ø±ÙˆØ¹ ØªØ³Øª Ø§Ø±Ø³Ø§Ù„ Ù„Ø§Ú¯...', 'info', 'send_test_start');
                
                const testData = {
                    level: 'info',
                    message: 'ØªØ³Øª Ù…Ø³ØªÙ‚ÛŒÙ… Ø§Ø±Ø³Ø§Ù„ Ù„Ø§Ú¯ Ø§Ø² Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨',
                    data: {
                        debug: true,
                        test_type: 'direct_send',
                        timestamp: new Date().toISOString()
                    }
                };
                
                const response = await fetch('./backend/api/v1/logging.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(testData)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    updateStatus('sendLogStatus', 'âœ… Ù„Ø§Ú¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯', 'success');
                    logDebug(`âœ… Ù„Ø§Ú¯ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯: ${result.message}`, 'info', 'send_test');
                } else {
                    const errorText = await response.text();
                    throw new Error(`HTTP ${response.status}: ${errorText}`);
                }
            } catch (error) {
                updateStatus('sendLogStatus', `âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„: ${error.message}`, 'error');
                logDebug(`âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„ Ù„Ø§Ú¯: ${error.message}`, 'errors', 'send_test');
            }
        }

        // ØªØ³Øª global error
        function testGlobalError() {
            try {
                logDebug('ğŸ”„ Ø§ÛŒØ¬Ø§Ø¯ Ø®Ø·Ø§ÛŒ JavaScript...', 'info', 'global_error_start');
                
                // Ø§ÛŒØ¬Ø§Ø¯ Ø®Ø·Ø§ÛŒ Ø¹Ù…Ø¯ÛŒ
                throw new Error('ØªØ³Øª Ø®Ø·Ø§ÛŒ JavaScript Ø§Ø² Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨');
                
            } catch (error) {
                updateStatus('globalErrorStatus', 'âœ… Ø®Ø·Ø§ÛŒ JavaScript Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯', 'warning');
                logDebug(`âœ… Ø®Ø·Ø§ÛŒ JavaScript: ${error.message}`, 'warnings', 'global_error');
                
                // Ø§Ø±Ø³Ø§Ù„ Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ Logger
                if (window.Logger) {
                    window.Logger.error('Ø®Ø·Ø§ÛŒ ØªØ³Øª Ø§Ø² Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨', error, {
                        source: 'debugger',
                        test_type: 'manual_error'
                    });
                }
            }
        }

        // ØªØ³Øª Promise error
        function testPromiseError() {
            logDebug('ğŸ”„ Ø§ÛŒØ¬Ø§Ø¯ Promise rejection...', 'info', 'promise_error_start');
            
            // Promise Ø±Ø¯ Ø´Ø¯Ù‡
            Promise.reject(new Error('ØªØ³Øª Promise rejection Ø§Ø² Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨'))
                .catch(error => {
                    updateStatus('promiseErrorStatus', 'âœ… Promise error Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯', 'warning');
                    logDebug(`âœ… Promise rejection: ${error.message}`, 'warnings', 'promise_error');
                });
        }

        // ØªØ³Øª Logger.error
        function testLoggerError() {
            try {
                logDebug('ğŸ”„ ØªØ³Øª Logger.error()...', 'info', 'logger_error_start');
                
                if (window.Logger) {
                    const testError = new Error('ØªØ³Øª Ø®Ø·Ø§ÛŒ Ù…Ø³ØªÙ‚ÛŒÙ… Ø§Ø² Logger');
                    window.Logger.error('Ø®Ø·Ø§ÛŒ ØªØ³Øª Logger', testError, {
                        source: 'debugger',
                        test_type: 'direct_logger_error',
                        timestamp: new Date().toISOString()
                    });
                    
                    updateStatus('loggerErrorStatus', 'âœ… Logger.error() Ø§Ø¬Ø±Ø§ Ø´Ø¯', 'success');
                    logDebug('âœ… Logger.error() Ø§Ø¬Ø±Ø§ Ø´Ø¯', 'info', 'logger_error');
                } else {
                    throw new Error('Logger Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª');
                }
            } catch (error) {
                updateStatus('loggerErrorStatus', `âŒ Ø®Ø·Ø§: ${error.message}`, 'error');
                logDebug(`âŒ Ø®Ø·Ø§ Ø¯Ø± Logger.error(): ${error.message}`, 'errors', 'logger_error');
            }
        }

        // Ø¨Ø±Ø±Ø³ÛŒ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø³Ø±ÙˆØ±
        async function checkServerLogs() {
            try {
                logDebug('ğŸ”„ Ø¯Ø±ÛŒØ§ÙØª Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø³Ø±ÙˆØ±...', 'info', 'server_logs_start');
                
                const response = await fetch('./backend/api/v1/logging.php?action=logs&limit=10');
                const result = await response.json();
                
                if (result.success) {
                    updateStatus('serverLogsStatus', `âœ… ${result.data.length} Ù„Ø§Ú¯ Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯`, 'success');
                    logDebug(`âœ… Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø³Ø±ÙˆØ± (${result.data.length} Ù…ÙˆØ±Ø¯):`, 'info', 'server_logs');
                    
                    result.data.forEach((log, index) => {
                        logDebug(`${index + 1}. [${log.timestamp}] ${log.level}: ${log.message}`);
                    });
                } else {
                    throw new Error(result.message);
                }
            } catch (error) {
                updateStatus('serverLogsStatus', `âŒ Ø®Ø·Ø§: ${error.message}`, 'error');
                logDebug(`âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù„Ø§Ú¯â€ŒÙ‡Ø§: ${error.message}`, 'errors', 'server_logs');
            }
        }

        // Ø¯Ø±ÛŒØ§ÙØª Ø¢Ù…Ø§Ø±
        async function getLogStats() {
            try {
                logDebug('ğŸ”„ Ø¯Ø±ÛŒØ§ÙØª Ø¢Ù…Ø§Ø± Ù„Ø§Ú¯â€ŒÙ‡Ø§...', 'info', 'stats_start');
                
                const response = await fetch('./backend/api/v1/logging.php?action=stats');
                const result = await response.json();
                
                if (result.success) {
                    updateStatus('logStatsStatus', 'âœ… Ø¢Ù…Ø§Ø± Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯', 'success');
                    logDebug(`âœ… Ø¢Ù…Ø§Ø± Ù„Ø§Ú¯â€ŒÙ‡Ø§: ${JSON.stringify(result.data, null, 2)}`, 'info', 'stats');
                } else {
                    throw new Error(result.message);
                }
            } catch (error) {
                updateStatus('logStatsStatus', `âŒ Ø®Ø·Ø§: ${error.message}`, 'error');
                logDebug(`âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¢Ù…Ø§Ø±: ${error.message}`, 'errors', 'stats');
            }
        }

        // Ø¹Ù…Ù„Ú©Ø±Ø¯Ù‡Ø§ÛŒ Ú©Ù…Ú©ÛŒ
        function clearOutput() {
            document.getElementById('debugOutput').textContent = 'Ø®Ø±ÙˆØ¬ÛŒ Ù¾Ø§Ú© Ø´Ø¯...\n';
            debugResults = {
                timestamp: new Date().toISOString(),
                tests: {},
                errors: [],
                warnings: [],
                info: []
            };
        }

        function exportResults() {
            const dataStr = JSON.stringify(debugResults, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `debug-results-${new Date().toISOString().slice(0,10)}.json`;
            link.click();
            
            logDebug('ğŸ“ Ù†ØªØ§ÛŒØ¬ Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ Ø®Ø±ÙˆØ¬ÛŒ Ú¯Ø±ÙØªÙ‡ Ø´Ø¯', 'info', 'export');
        }

        // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        document.addEventListener('DOMContentLoaded', function() {
            logDebug('ğŸš€ Ø´Ø±ÙˆØ¹ Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ Ø³ÛŒØ³ØªÙ… Ù„Ø§Ú¯â€ŒÚ¯ÛŒØ±ÛŒ DataSave');
            
            // Ø§Ù†ØªØ¸Ø§Ø± Ú©ÙˆØªØ§Ù‡ Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ø§Ù…Ù„ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§
            setTimeout(() => {
                checkModuleLoading();
            }, 1000);
            
            // Ø±ØµØ¯ Ø®Ø·Ø§Ù‡Ø§ÛŒ Ø³Ø±Ø§Ø³Ø±ÛŒ
            window.addEventListener('error', function(event) {
                logDebug(`ğŸš¨ Global Error Handler: ${event.message} Ø¯Ø± ${event.filename}:${event.lineno}`, 'warnings', 'global_capture');
            });

            window.addEventListener('unhandledrejection', function(event) {
                logDebug(`ğŸš¨ Unhandled Rejection: ${event.reason}`, 'warnings', 'rejection_capture');
            });
        });
    </script>
</body>
</html>